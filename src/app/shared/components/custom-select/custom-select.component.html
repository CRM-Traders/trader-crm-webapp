<div class="relative inline-block w-full">
  <button
    type="button"
    class="w-full border border-gray-300 rounded-md bg-white text-left text-sm px-3 py-2 flex items-center justify-between disabled:opacity-50 disabled:cursor-not-allowed"
    [disabled]="disabled"
    (click)="toggle($event)"
    data-role="trigger"
  >
    <span class="truncate">{{ selectedLabel }}</span>
    <svg
      class="w-4 h-4 ml-2 transition-transform"
      [class.rotate-180]="isOpen"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
    </svg>
  </button>

  <!-- Rendered into body via template when opened -->
  <ng-template #dropdownTemplate>
    <div class="rounded-md bg-white border border-gray-300 shadow-lg" [style.max-height.px]="maxHeight">
      <div class="p-2 border-b border-gray-200">
        <input
          type="text"
          class="w-full px-2 py-1 text-xs border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          placeholder="Search..."
          [value]="filterQuery"
          (input)="onFilterChange($any($event.target).value)"
          autofocus
        />
      </div>
      <div class="max-h-60 overflow-y-auto">
        <button
          class="w-full text-left px-2 py-1 text-xs hover:bg-gray-50"
          *ngFor="let opt of filteredOptions"
          (click)="selectValue(opt.value)"
        >
          {{ opt.label }}
        </button>
        <div class="px-2 py-1 text-xs text-gray-500" *ngIf="filteredOptions.length === 0">
          No results
        </div>
      </div>
    </div>
  </ng-template>
</div>


